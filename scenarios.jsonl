{"name": "tool-executor-panic-recovery", "description": "Validates that before hooks can panic without crashing tool execution", "given": ["A tool executor with registered tools", "A before hook that panics"], "when": ["Tool execution is requested"], "then": ["Execution completes successfully", "Panic is logged to stderr", "Subsequent hooks still execute"], "validates": ["tool/executor.go panic recovery", "Error logging for hook failures"]}
{"name": "agent-hierarchy-spawn-cleanup", "description": "Validates concurrent agent spawning and cleanup operations", "given": ["A root agent with registry and LLM client", "Multiple goroutines spawning children"], "when": ["Children are spawned concurrently", "Children are removed individually and in bulk"], "then": ["All spawns succeed without race conditions", "RemoveChild removes single child", "RemoveAllChildren removes all children"], "validates": ["agent/agent.go SpawnChild lock optimization", "agent/agent.go RemoveChild and RemoveAllChildren"]}
{"name": "agent-config-caching", "description": "Validates lazy Config() initialization avoids repeated deep copies", "given": ["An agent with tool configuration (AllowedTools, DeniedTools)"], "when": ["Config() is called many times concurrently"], "then": ["All calls return consistent data", "Performance is good (caching works)", "Note: returned config should not be modified per documentation"], "validates": ["agent/agent.go sync.Once lazy initialization", "Performance optimization for frequently-called method"]}
{"name": "coordinator-cache-race-condition", "description": "Validates cache lock upgrade pattern has no race condition", "given": ["A TTL cache with short expiration times"], "when": ["Many goroutines read and write with expiring items"], "then": ["No race condition panic occurs", "Expired items are properly cleaned up", "Test completes without data races"], "validates": ["coordinator/cache.go lock upgrade fix", "Proper read lock release before write lock acquisition"]}
{"name": "filtered-registry-count-optimization", "description": "Validates Count() method counts directly without allocating full slice", "given": ["A registry with many tools (100+)", "A filtered registry allowing subset of tools"], "when": ["Count() is called many times"], "then": ["Correct count is returned", "Performance is reasonable (no excessive allocation)"], "validates": ["tool/filter.go Count() optimization", "O(n) counting without slice allocation"]}
{"name": "orchestrator-context-cancellation", "description": "Validates orchestrator checks context before each tool execution", "given": ["An agent with a slow tool", "LLM that requests multiple tool calls"], "when": ["Run is called with a timeout context"], "then": ["Context cancellation is detected", "Not all tool calls complete", "Error is propagated correctly"], "validates": ["orchestrator/orchestrator.go context checks", "Proper context propagation in tool execution loop"]}
